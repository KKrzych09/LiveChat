{"ast":null,"code":"import { projectFirestore } from \"@/firebase/config\";\nimport { ref, watchEffect } from \"vue\";\n\nconst getCollection = collection => {\n  const documents = ref(null);\n  const error = ref(null);\n  let collectionRef = projectFirestore.collection(collection).orderBy('createdAt');\n  const unsub = collectionRef.onSnapshot(snap => {\n    let results = [];\n    snap.docs.forEach(doc => {\n      doc.data().createdAt && results.push({ ...doc.data(),\n        id: doc.id\n      });\n    });\n    documents.value = results;\n    error.value = null;\n  }, err => {\n    console.log(err.message);\n    documents.value = null;\n    error.value = 'Could not fetch data';\n  });\n  watchEffect(onInvalidate => {\n    // unsub from prev collection when watcher is stopped (component unmounted)\n    onInvalidate(() => {});\n  });\n  return {\n    documents,\n    error\n  };\n};\n\nexport default getCollection;","map":{"version":3,"names":["projectFirestore","ref","watchEffect","getCollection","collection","documents","error","collectionRef","orderBy","unsub","onSnapshot","snap","results","docs","forEach","doc","data","createdAt","push","id","value","err","console","log","message","onInvalidate"],"sources":["/Users/kamil/Desktop/Programowanie/JavaScript/Vue/live-chat/src/composables/getCollection.js"],"sourcesContent":["import { projectFirestore } from \"@/firebase/config\";\nimport { ref, watchEffect } from \"vue\";\n\nconst getCollection = (collection) => {\n    const documents = ref(null)\n    const error = ref(null)\n\n    let collectionRef = projectFirestore.collection(collection)\n        .orderBy('createdAt')\n        \n    const unsub = collectionRef.onSnapshot((snap) => {\n        let results = []\n        snap.docs.forEach(doc => {\n            doc.data().createdAt && results.push({ ...doc.data(), id: doc.id })\n        })\n        documents.value = results\n        error.value = null\n    }, (err) => {\n        console.log(err.message)\n        documents.value = null\n        error.value = 'Could not fetch data'\n    })\n\n    watchEffect((onInvalidate) => {\n        // unsub from prev collection when watcher is stopped (component unmounted)\n        onInvalidate(() => {\n\n        })\n    })\n\n    return { documents, error }\n\n}\n\nexport default getCollection"],"mappings":"AAAA,SAASA,gBAAT,QAAiC,mBAAjC;AACA,SAASC,GAAT,EAAcC,WAAd,QAAiC,KAAjC;;AAEA,MAAMC,aAAa,GAAIC,UAAD,IAAgB;EAClC,MAAMC,SAAS,GAAGJ,GAAG,CAAC,IAAD,CAArB;EACA,MAAMK,KAAK,GAAGL,GAAG,CAAC,IAAD,CAAjB;EAEA,IAAIM,aAAa,GAAGP,gBAAgB,CAACI,UAAjB,CAA4BA,UAA5B,EACfI,OADe,CACP,WADO,CAApB;EAGA,MAAMC,KAAK,GAAGF,aAAa,CAACG,UAAd,CAA0BC,IAAD,IAAU;IAC7C,IAAIC,OAAO,GAAG,EAAd;IACAD,IAAI,CAACE,IAAL,CAAUC,OAAV,CAAkBC,GAAG,IAAI;MACrBA,GAAG,CAACC,IAAJ,GAAWC,SAAX,IAAwBL,OAAO,CAACM,IAAR,CAAa,EAAE,GAAGH,GAAG,CAACC,IAAJ,EAAL;QAAiBG,EAAE,EAAEJ,GAAG,CAACI;MAAzB,CAAb,CAAxB;IACH,CAFD;IAGAd,SAAS,CAACe,KAAV,GAAkBR,OAAlB;IACAN,KAAK,CAACc,KAAN,GAAc,IAAd;EACH,CAPa,EAOVC,GAAD,IAAS;IACRC,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,OAAhB;IACAnB,SAAS,CAACe,KAAV,GAAkB,IAAlB;IACAd,KAAK,CAACc,KAAN,GAAc,sBAAd;EACH,CAXa,CAAd;EAaAlB,WAAW,CAAEuB,YAAD,IAAkB;IAC1B;IACAA,YAAY,CAAC,MAAM,CAElB,CAFW,CAAZ;EAGH,CALU,CAAX;EAOA,OAAO;IAAEpB,SAAF;IAAaC;EAAb,CAAP;AAEH,CA7BD;;AA+BA,eAAeH,aAAf"},"metadata":{},"sourceType":"module"}