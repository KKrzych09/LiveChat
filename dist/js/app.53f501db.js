(function(){"use strict";var e={9235:function(e,n,r){var t=r(9242),a=r(3396);function o(e,n){const r=(0,a.up)("router-view");return(0,a.wg)(),(0,a.j4)(r)}var s=r(89);const l={},u=(0,s.Z)(l,[["render",o]]);var i=u,c=r(2483);const d={class:"welcome container"},p=(0,a._)("p",null,"Welcome",-1),m={key:0},v=(0,a._)("h2",null,"Login",-1),g=(0,a.Uk)("No account yet? "),h=(0,a.Uk)(" instead"),w={key:1},f=(0,a._)("h2",null,"Sign up",-1),y=(0,a.Uk)("Already registered? "),b=(0,a.Uk)(" instead");function _(e,n,r,t,o,s){const l=(0,a.up)("LoginForm"),u=(0,a.up)("SignupForm");return(0,a.wg)(),(0,a.iD)("div",d,[p,t.showLogin?((0,a.wg)(),(0,a.iD)("div",m,[v,(0,a.Wm)(l,{onLogin:t.enterChat},null,8,["onLogin"]),(0,a._)("p",null,[g,(0,a._)("span",{onClick:n[0]||(n[0]=e=>t.showLogin=!1)},"Signup"),h])])):((0,a.wg)(),(0,a.iD)("div",w,[f,(0,a.Wm)(u,{onSignup:t.enterChat},null,8,["onSignup"]),(0,a._)("p",null,[y,(0,a._)("span",{onClick:n[1]||(n[1]=e=>t.showLogin=!0)},"Login"),b])]))])}var k=r(7139);const S={class:"error"},C=(0,a._)("button",null,"Sign up",-1);function D(e,n,r,o,s,l){return(0,a.wg)(),(0,a.iD)("form",{onSubmit:n[3]||(n[3]=(0,t.iM)(((...e)=>o.handleSubmit&&o.handleSubmit(...e)),["prevent"]))},[(0,a.wy)((0,a._)("input",{type:"text",required:"",placeholder:"display name","onUpdate:modelValue":n[0]||(n[0]=e=>o.displayName=e)},null,512),[[t.nr,o.displayName]]),(0,a.wy)((0,a._)("input",{type:"email",required:"",placeholder:"email","onUpdate:modelValue":n[1]||(n[1]=e=>o.email=e)},null,512),[[t.nr,o.email]]),(0,a.wy)((0,a._)("input",{type:"password",required:"",placeholder:"password","onUpdate:modelValue":n[2]||(n[2]=e=>o.password=e)},null,512),[[t.nr,o.password]]),(0,a._)("div",S,(0,k.zw)(o.error),1),C],32)}var H=r(4870),U=(r(1703),r(4275));r(2702),r(4059);const A={apiKey:"AIzaSyCR3aNishYrJKhNQKxroqKRm7KsQESga2E",authDomain:"vue-firebase-sites-cf6cd.firebaseapp.com",projectId:"vue-firebase-sites-cf6cd",storageBucket:"vue-firebase-sites-cf6cd.appspot.com",messagingSenderId:"908253611293",appId:"1:908253611293:web:9551ee829f932fc8c28df4"};U.Z.initializeApp(A);const N=U.Z.auth(),O=U.Z.firestore(),Z=U.Z.firestore.FieldValue.serverTimestamp,L=(0,H.iH)(null),z=async(e,n,r)=>{L.value=null;try{const t=await N.createUserWithEmailAndPassword(e,n);if(!t)throw new Error("Could not complete signup");return await t.user.updateProfile({displayName:r}),L.value=null,t}catch(t){console.log(t.message),L.value=t.message}},q=()=>({error:L,signup:z});var W=q,E={setup(e,n){const r=(0,H.iH)(""),t=(0,H.iH)(""),a=(0,H.iH)(""),{error:o,signup:s}=W(),l=async()=>{await s(t.value,a.value,r.value),o.value||n.emit("signup")};return{displayName:r,email:t,password:a,handleSubmit:l,error:o}}};const F=(0,s.Z)(E,[["render",D]]);var j=F;const x={class:"error"},I=(0,a._)("button",null,"Log in",-1);function K(e,n,r,o,s,l){return(0,a.wg)(),(0,a.iD)("form",{onSubmit:n[2]||(n[2]=(0,t.iM)(((...e)=>o.handleSubmit&&o.handleSubmit(...e)),["prevent"]))},[(0,a.wy)((0,a._)("input",{type:"email",required:"",placeholder:"email","onUpdate:modelValue":n[0]||(n[0]=e=>o.email=e)},null,512),[[t.nr,o.email]]),(0,a.wy)((0,a._)("input",{type:"password",required:"",placeholder:"password","onUpdate:modelValue":n[1]||(n[1]=e=>o.password=e)},null,512),[[t.nr,o.password]]),(0,a._)("div",x,(0,k.zw)(o.error),1),I],32)}const P=(0,H.iH)(null),V=async(e,n)=>{P.value=null;try{const r=await N.signInWithEmailAndPassword(e,n);return P.value=null,console.log(r),r}catch(r){console.log(r.message),P.value="Incorrect login data"}},T=()=>({error:P,login:V});var M=T,Y={setup(e,n){const r=(0,H.iH)(""),t=(0,H.iH)(""),{error:a,login:o}=M(),s=async()=>{await o(r.value,t.value),a.value||n.emit("login")};return{email:r,password:t,handleSubmit:s,error:a}}};const B=(0,s.Z)(Y,[["render",K]]);var Q=B,R={components:{SignupForm:j,LoginForm:Q},setup(){const e=(0,H.iH)(!0),n=(0,c.tv)(),r=()=>{n.push({name:"chatroom"})};return{showLogin:e,enterChat:r}}};const J=(0,s.Z)(R,[["render",_]]);var G=J;const X={key:0,class:"container"};function $(e,n,r,t,o,s){const l=(0,a.up)("Navbar"),u=(0,a.up)("ChatWindow"),i=(0,a.up)("NewChatForm");return t.user?((0,a.wg)(),(0,a.iD)("div",X,[(0,a.Wm)(l),(0,a.Wm)(u),(0,a.Wm)(i)])):(0,a.kq)("",!0)}const ee={key:0},ne={class:"email"};function re(e,n,r,t,o,s){return t.user?((0,a.wg)(),(0,a.iD)("nav",ee,[(0,a._)("div",null,[(0,a._)("p",null,"Hey there "+(0,k.zw)(t.user.displayName),1),(0,a._)("p",ne,"Currently logged in as "+(0,k.zw)(t.user.email),1)]),(0,a._)("button",{onClick:n[0]||(n[0]=(...e)=>t.handleClick&&t.handleClick(...e))},"Logout")])):(0,a.kq)("",!0)}const te=(0,H.iH)(null),ae=async()=>{te.value=null;try{await N.signOut()}catch(e){console.log(e.message),te.value=e.message}},oe=()=>({logout:ae,error:te});var se=oe;const le=(0,H.iH)(N.currentUser);N.onAuthStateChanged((e=>{console.log("User state change. Current user is:",e),le.value=e}));const ue=()=>({user:le});var ie=ue,ce={setup(){const{logout:e,error:n}=se(),{user:r}=ie(),t=async()=>{await e(),n.value||console.log("user logged out")};return{handleClick:t,user:r}}};const de=(0,s.Z)(ce,[["render",re]]);var pe=de;const me={class:"error"};function ve(e,n,r,o,s,l){return(0,a.wg)(),(0,a.iD)("form",null,[(0,a.wy)((0,a._)("textarea",{placeholder:"Type a message and hit enter to send...","onUpdate:modelValue":n[0]||(n[0]=e=>o.message=e),onKeypress:n[1]||(n[1]=(0,t.D2)((0,t.iM)(((...e)=>o.handleSubmit&&o.handleSubmit(...e)),["prevent"]),["enter"]))},null,544),[[t.nr,o.message]]),(0,a._)("div",me,(0,k.zw)(o.error),1)])}const ge=e=>{let n=(0,H.iH)(null);const r=async r=>{n.value=null;try{await O.collection(e).add(r)}catch(t){console.log(t.message),n.value="could not send the message"}};return{error:n,addDoc:r}};var he=ge,we={setup(){const{user:e}=ie(),{addDoc:n,error:r}=he("messages"),t=(0,H.iH)(""),a=async()=>{const a={name:e.value.displayName,message:t.value,createdAt:Z()};await n(a),r.value||(t.value="")};return{message:t,handleSubmit:a,error:r}}};const fe=(0,s.Z)(we,[["render",ve],["__scopeId","data-v-964e630a"]]);var ye=fe;const be={class:"chat-window"},_e={key:0},ke={key:1,class:"messages",ref:"messages"},Se={class:"created-at"},Ce={class:"name"},De={class:"message"};function He(e,n,r,t,o,s){return(0,a.wg)(),(0,a.iD)("div",be,[t.error?((0,a.wg)(),(0,a.iD)("div",_e,(0,k.zw)(t.error),1)):(0,a.kq)("",!0),t.documents?((0,a.wg)(),(0,a.iD)("div",ke,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.formattedDocuments,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e.id,class:"single"},[(0,a._)("span",Se,(0,k.zw)(e.createdAt),1),(0,a._)("span",Ce,(0,k.zw)(e.name),1),(0,a._)("span",De,(0,k.zw)(e.message),1)])))),128))],512)):(0,a.kq)("",!0)])}const Ue=e=>{const n=(0,H.iH)(null),r=(0,H.iH)(null);let t=O.collection(e).orderBy("createdAt");const o=t.onSnapshot((e=>{let t=[];e.docs.forEach((e=>{e.data().createdAt&&t.push({...e.data(),id:e.id})})),n.value=t,r.value=null}),(e=>{console.log(e.message),n.value=null,r.value="Could not fetch data"}));return(0,a.m0)((e=>{e((()=>o()))})),{documents:n,error:r}};var Ae=Ue,Ne=r(3621),Oe={setup(){const{error:e,documents:n}=Ae("messages"),r=(0,a.Fl)((()=>{if(n.value)return n.value.map((e=>{let n=(0,Ne.Z)(e.createdAt.toDate());return{...e,createdAt:n}}))})),t=(0,H.iH)(null);return(0,a.ic)((()=>{t.value.scrollTop=t.value.scrollHeight})),{error:e,documents:n,formattedDocuments:r,messages:t}}};const Ze=(0,s.Z)(Oe,[["render",He]]);var Le=Ze,ze={components:{Navbar:pe,NewChatForm:ye,ChatWindow:Le},setup(){const{user:e}=ie(),n=(0,c.tv)();return(0,a.YP)(e,(()=>{e.value||n.push({name:"welcome"})})),{user:e}}};const qe=(0,s.Z)(ze,[["render",$]]);var We=qe;const Ee=(e,n,r)=>{let t=N.currentUser;t||r({name:"welcome"}),r()},Fe=(e,n,r)=>{let t=N.currentUser;t?r({name:"chatroom"}):r()},je=[{path:"/",name:"welcome",component:G,beforeEnter:Fe},{path:"/chatroom",name:"chatroom",component:We,beforeEnter:Ee}],xe=(0,c.p7)({history:(0,c.PO)("/"),routes:je});var Ie=xe;let Ke;N.onAuthStateChanged((()=>{Ke||(Ke=(0,t.ri)(i).use(Ie).mount("#app"))}))}},n={};function r(t){var a=n[t];if(void 0!==a)return a.exports;var o=n[t]={exports:{}};return e[t](o,o.exports,r),o.exports}r.m=e,function(){var e=[];r.O=function(n,t,a,o){if(!t){var s=1/0;for(c=0;c<e.length;c++){t=e[c][0],a=e[c][1],o=e[c][2];for(var l=!0,u=0;u<t.length;u++)(!1&o||s>=o)&&Object.keys(r.O).every((function(e){return r.O[e](t[u])}))?t.splice(u--,1):(l=!1,o<s&&(s=o));if(l){e.splice(c--,1);var i=a();void 0!==i&&(n=i)}}return n}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[t,a,o]}}(),function(){r.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(n,{a:n}),n}}(),function(){r.d=function(e,n){for(var t in n)r.o(n,t)&&!r.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}}(),function(){var e={143:0};r.O.j=function(n){return 0===e[n]};var n=function(n,t){var a,o,s=t[0],l=t[1],u=t[2],i=0;if(s.some((function(n){return 0!==e[n]}))){for(a in l)r.o(l,a)&&(r.m[a]=l[a]);if(u)var c=u(r)}for(n&&n(t);i<s.length;i++)o=s[i],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return r.O(c)},t=self["webpackChunklive_chat"]=self["webpackChunklive_chat"]||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))}();var t=r.O(void 0,[998],(function(){return r(9235)}));t=r.O(t)})();
//# sourceMappingURL=app.53f501db.js.map